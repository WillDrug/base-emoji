import test from 'ava'
import {encode, decode, decodeText} from '..'

const fixtures = [
  {
    title: 'String',
    unencoded: Array.from('sebastiaan deckers')
      .map((letter, index, letters) => {
        return letters.slice(0, index + 1).join('')
      }),
    encoded: [
      'ðŸ¦ðŸ•’',
      'ðŸ¦ðŸ ðŸ•ž',
      'ðŸ¦ðŸ¡ðŸŠðŸ•“',
      'ðŸ¦ðŸ¡ðŸ²ðŸ™‚ðŸ•Ÿ',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ‘®ðŸ•”',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ‡ðŸ• ',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸŠðŸ••',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ‡ðŸ•¡',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ•’',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸŠðŸ•ž',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸœðŸ•“',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ˜¼ðŸ•Ÿ',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ™‰ðŸ‘®ðŸ•”',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ™‰ðŸ™†ðŸ—¯ðŸ• ',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ™‰ðŸ™†ðŸŽ“ðŸŠðŸ••',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ™‰ðŸ™†ðŸŽ“ðŸ’£ðŸ˜€ðŸ•¡',
      'ðŸ¦ðŸ¡ðŸ²ðŸ˜ðŸ’ðŸ¡ðŸ’šðŸ ðŸ’ðŸ‹ðŸ•·ðŸ™‰ðŸ™†ðŸŽ“ðŸ’£ðŸš¶'
    ]
  },
  {
    title: 'TypedArray',
    unencoded: new Uint8Array([
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0
    ])
      .reduce((unencoded, byte, index, bytes) => {
        const slice = bytes.slice(0, index + 1)
        unencoded.push(slice)
        return unencoded
      }, []),
    encoded: [
      'ðŸ˜€ðŸ•’',
      'ðŸ˜€ðŸ˜€ðŸ•ž',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ•“',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ•Ÿ',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ•”',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ• ',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ••',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ•¡',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ›¥ðŸ•’',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšˆðŸ•ž',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒðŸ•“',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒ‹ðŸ‡ðŸ•Ÿ',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒ‹ðŸ¸ðŸ˜€ðŸ•”',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒ‹ðŸ¸ðŸ˜«ðŸ˜€ðŸ• ',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒ‹ðŸ¸ðŸ˜«ðŸ˜¡ðŸ˜€ðŸ••',
      'ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸ˜€ðŸš¢ðŸšðŸŒ‹ðŸ¸ðŸ˜«ðŸ˜¡ðŸ—£ðŸ˜€ðŸ•¡'
    ]
  }
]

fixtures.forEach(({encoded, unencoded, title}) => test(title, (t) => {
  encoded.forEach((emoji, index) => {
    const data = unencoded[index]

    // Encoding
    t.is(encode(data), emoji)

    // Decoding
    if (data instanceof Uint8Array) {
      t.deepEqual(decode(emoji), data)
    } else if (typeof data === 'string') {
      t.is(decodeText(emoji), data)
    }
  })
}))
